$(() => {
    $("#create").validate({
        // todo check the uniqueness of the data for current logged in user
        rules: {
            name: {
                required: true
            },
            nip: {
                required: true,
                exactLength: 10,
                number: true,
            },
            account_number: {
                required: true,
                accountNumber: true,
            },
            email: {
                required: true,
                email: true
            },
            phone: {
                required: true,
            },
            street: {
                required: true
            },
            city: {
                required: true
            },
            post_code: {
                required: true,
            }
        }
    })
});

$(document).ready(() => {
    $("#create").on("submit", submitCreate);
});

function submitCreate(event) {
    event.preventDefault();
    if ($("#create").valid()) {
        $("#progressText").html("Trwa dodawanie...");
        $("#progressBar").removeClass("d-none");
        $("#create input[type='submit']").prop("disabled", true);
        $.ajax({
            type: "POST",
            url: "/recipients/store",
            data: $("#create").serialize()
        })
            .done((response) => displayResponse('create', response))
            .fail(error => displayResponse('create', 0));
    }
}
